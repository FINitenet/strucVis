# LICENSE
strucVis : Display small RNA depth of coverage on a predicted RNA
    secondary structure

Copyright (C) 2016-2018 Michael J. Axtell

This program is free software: you can redistribute it and/or modify it
    under the terms of the GNU General Public License as published by the
    Free Software Foundation, either version 3 of the License, or (at your
    option) any later version.

This program is distributed in the hope that it will be useful,
        but WITHOUT ANY WARRANTY; without even the implied warranty of
        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
        GNU General Public License for more details.

You should have received a copy of the GNU General Public License
        along with this program.  If not, see <http://www.gnu.org/licenses/>.

AUTHOR
    Michael J. Axtell, Penn State University mja18@psu.edu

REQUIREMENTS
- perl5 (installed at /usr/bin/perl)
- samtools (installed in your PATH)
- RNAfold (installed in your PATH)

USAGE

`strucVis -b [bam] -g [genome] -c [Chr:start-stop] -s [strand 'plus' or 'minus'] -p [output.ps] -n [Locus name]`

INPUTS
```
    -b : path to sorted and indexed BAM alignment file of small RNAs

    -g : path to FASTA formatted reference genome. Must be indexed using
    samtools faidx.

    -c : Coordinates of interest in format Chr:start-stop.

    -s : Strand of interest. Either 'plus' or 'minus'.

    -p : Output postscript file name. Must end in .ps

    -n : Name of locus. Prints name in the .ps file and on the plain text
    alignments. If not provided, defaults to 'Unnamed Locus'

SWITCHES
    -x : Suppress the printing of detailed file information on the
    post-script file

    -v : Print the version and quit

    -h : Print help message and quit
```

OUTPUT

- A post-script image showing the predicted RNA secondary structure with each nucleotide color-coded to represent the depth of sRNA alignments. ![strucVis_image](./example.png)
- A plain-text file showing the predicted RNA secondary structure using dot-bracket notation, with sRNA alignments shown underneath.

```
Genome: /Users/michaelaxtell/Desktop/ShortStack_Testing/TAIR10_genome.fa
Alignments: /Users/michaelaxtell/Desktop/ShortStack_Testing/ShortStack_1467901443/Apr2M_R1_trimmed_ca.bam
Location: 1:17825685-17825857 plus
Post-script file name: example.ps
UGCUUGAUCUCGGUUUUUGACCAGUUUAUUGCGUCGAUCAAUGCAUUGAAAGUGACUACAUCGGGGUUCCGAUUUUUUUUGUUCUUCAUAUGAUGAAGCGGAAACAGUAAUCAACCCUGGUUUAGUCACUUUCACUGCAUUAAUCAAUGCAUUUGUAAAAAGAGGGAAAAGCA
(((((..((((((((...))))..((((((((((.(((.((((((.((((((((((((.(((((((((...(((.((((((..((((((...)))))))))))).)))....))))))))).)))))))))))).)))))).))).)))))...)))))..))))...))))) (-62.80)
....................................cUCAAUGCAUUGAAAGUGACUA................................................................................................................... len:22 al:1
....................................AUCAAUGCAUUGAAAGUGACU.................................................................................................................... len:21 al:5
.....................................UCAAUGCAUUcAAAGUGACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAAAGUGACg.................................................................................................................... len:20 al:8
.....................................UCAAUGCAUUGAAAGaGACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAAAGUGAgUA................................................................................................................... len:21 al:1
.....................................aCAAUGCAUUGAAAGUGACU.................................................................................................................... len:20 al:7
.....................................UCAAUGCAUUGAAgGUGACU.................................................................................................................... len:20 al:1
.....................................UCAuUGCAUUGAAAGUGACUA................................................................................................................... len:21 al:1
.....................................UCAAUGCAUUGAAAGUaACUA................................................................................................................... len:21 al:2
.....................................UCAAUGCAUUGAAAGUGACUuC.................................................................................................................. len:22 al:2
.....................................UCAAUGCAUUGAAAGUGACUA................................................................................................................... len:21 al:816
.....................................UCcAUGCAUUGAAAGUGACUA................................................................................................................... len:21 al:1
.....................................UCAAUGCAUUGAAAGgGACUA................................................................................................................... len:21 al:1
.....................................gCAAUGCAUUGAAAGUGACU.................................................................................................................... len:20 al:5
.....................................UCAAUGCAUUGAAAGUGACUg................................................................................................................... len:21 al:2
.....................................UaAAUGCAUUGAAAGUGACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAAAGUGACUu................................................................................................................... len:21 al:74
.....................................UCAAUGCAUUGAAAGUGACUAuAU................................................................................................................ len:24 al:1
.....................................UCAAUGCAUUaAAAGUGACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAAAGUuACUA................................................................................................................... len:21 al:1
.....................................UCAgUGCAUUGAAAGUGACUA................................................................................................................... len:21 al:1
.....................................UCAAUGCAUUGAAAGUGACUAa.................................................................................................................. len:22 al:4
.....................................UCAAUGCAUUGAAAGUG....................................................................................................................... len:17 al:8
.....................................UCAAUGCAUUGAAAGUcACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUuAAAGUGACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAAAG......................................................................................................................... len:15 al:1
.....................................UCAAUGCAUUGAAAGUGACU.................................................................................................................... len:20 al:3365
.....................................gCAAUGCAUUGAAAGUGACUA................................................................................................................... len:21 al:1
.....................................UCAAUGCAUUGAAAGUGACc.................................................................................................................... len:20 al:3
.....................................UCAAUGaAUUGAAAGUGACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAAAGU........................................................................................................................ len:16 al:2
.....................................UCAAUGCAUUGAAAGUGACUAu.................................................................................................................. len:22 al:45
.....................................UCAAUGCAUUGAAAGUGgCUA................................................................................................................... len:21 al:1
.....................................UCAAUGCAUUGAAAGcGACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAAAuUGACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAAAGUGAgU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAAAGUGACUACAU................................................................................................................ len:24 al:1
.....................................UCAAUGCuUUGAAAGUGACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAgAGUGACU.................................................................................................................... len:20 al:2
.....................................UCAAUGCAUUGAAAGUaACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAAAGUGACa.................................................................................................................... len:20 al:3
.....................................UCAAUGCAUUGuAAGUGACU.................................................................................................................... len:20 al:1
.....................................UCAAUGCAUUGAAAGUGAC..................................................................................................................... len:19 al:27
......................................CAAUGCAUUGAAAGUGACUA................................................................................................................... len:20 al:2
......................................CAAUGCAUUGAAAGUGACU.................................................................................................................... len:19 al:1
.........................................UGCAUUGAAAGUGACUACAUCGGG............................................................................................................ len:24 al:2
.........................................UGCAUUGAAAGUGACUA................................................................................................................... len:17 al:2
.........................................UGCAUUGAAAGUGACU.................................................................................................................... len:16 al:1
.........................................UGCAUUGAAAGUGACUACAUC............................................................................................................... len:21 al:2
..........................................GCAUUGAAAGUGACU.................................................................................................................... len:15 al:1
............................................AUUGAAAGUGACUACAUCGGG............................................................................................................ len:21 al:1
.............................................UUGAAAGUGACUACAUCGGGGUUC........................................................................................................ len:24 al:2
.............................................UUGAAAGUGAaUACAUCGGGG........................................................................................................... len:21 al:1
.............................................UUGAAAGUGACUACAUCGGGGUU......................................................................................................... len:23 al:8
.............................................UUGAAAGUcACUACAUCGGGG........................................................................................................... len:21 al:1
.............................................UUGAAAGUGACUACAUCG.............................................................................................................. len:18 al:12
.............................................UcGAAAGUGACUACAUCGGGG........................................................................................................... len:21 al:1
.............................................UUGAAAGUGACUACAUCGGGGa.......................................................................................................... len:22 al:8
.............................................UUGAAAGUGACUACA................................................................................................................. len:15 al:15
.............................................UUGAAAGUGACUACAUCGGGGg.......................................................................................................... len:22 al:2
.............................................UUGAAAGUGACUACAU................................................................................................................ len:16 al:5
.............................................UUGAAAGUGACUuCAUCGGGG........................................................................................................... len:21 al:1
.............................................UUGAAAGUGACUACAUCGGGc........................................................................................................... len:21 al:1
.............................................UUGAAAGUGACUACAUCGG............................................................................................................. len:19 al:1
.............................................UUGAAAGUGACUACAUCGu............................................................................................................. len:19 al:1
.............................................UUGAAAGUGACUACAUCGGGGUUu........................................................................................................ len:24 al:1
.............................................UUGAAAGUGACUACAUCGGGGc.......................................................................................................... len:22 al:1
.............................................UUGAAAGUGACUACAUCGGGu........................................................................................................... len:21 al:1
.............................................UUGAAAGUGACUACAUC............................................................................................................... len:17 al:25
.............................................UUGAAAGUGACUACAUCGGu............................................................................................................ len:20 al:2
.............................................UUGAAAGUGACUACAUCGGGG........................................................................................................... len:21 al:1144
.............................................UUGAAAGaGACUACAUCGGGG........................................................................................................... len:21 al:1
.............................................gUGAAAGUGACUACAUCGGGG........................................................................................................... len:21 al:2
.............................................UUGAAAGUGgCUACAUCGGGG........................................................................................................... len:21 al:1
.............................................UUGAAAaUGACUACAUCGGGG........................................................................................................... len:21 al:1
.............................................aUGAAAGUGACUACAUCGGGG........................................................................................................... len:21 al:1
.............................................UUGAAAGUGACUACAUCGGGGU.......................................................................................................... len:22 al:94
.............................................cUGAAAGUGACUACAUCGGGGU.......................................................................................................... len:22 al:4
.............................................UUGAAAGUGACUACAUCGuGG........................................................................................................... len:21 al:2
..............................................UGAuAGUGACUACAUCGGGGU.......................................................................................................... len:21 al:1
..............................................UuAAAGUGACUACAUCGGGG........................................................................................................... len:20 al:1
..............................................UGAAAGUGACUcCAUCGGGGU.......................................................................................................... len:21 al:1
..............................................UGAAAGUGACUACAUCGuGGU.......................................................................................................... len:21 al:1
..............................................UGAAAGUGACUACAUCGGGGU.......................................................................................................... len:21 al:3459
..............................................UGAAAGcGACUACAUCGGGG........................................................................................................... len:20 al:1
..............................................UGAAAGUGACUACAUC............................................................................................................... len:16 al:19
..............................................UGAAAGUGACUACAUCGGGuU.......................................................................................................... len:21 al:1
..............................................UGAAAGUGACUACAUCGGG............................................................................................................ len:19 al:1
..............................................UGAAAGUGACUACAUCGGGGUUu........................................................................................................ len:23 al:2
..............................................UGAAAGUGACUACAU................................................................................................................ len:15 al:2
..............................................aGAAAGUGACUACAUCGGGGU.......................................................................................................... len:21 al:1
..............................................UGAAAGUGACUACAUCGGGcU.......................................................................................................... len:21 al:2
..............................................UGAAAGUGACUAaAUCGGGGU.......................................................................................................... len:21 al:1
..............................................UGAAAGUGACUACAUCGGGGUU......................................................................................................... len:22 al:97
..............................................UGAAAGUGACUACAUCGGGu........................................................................................................... len:20 al:1
..............................................cGAAAGUGACUACAUCGGGGU.......................................................................................................... len:21 al:3
..............................................UGAAAGUGACUACAUCG.............................................................................................................. len:17 al:7
..............................................UGAAgGUGACUACAUCGGGGUU......................................................................................................... len:22 al:1
..............................................UGAAAGUGACUACAUCGGGGc.......................................................................................................... len:21 al:2
..............................................UGAAAGUGACUACAUCu.............................................................................................................. len:17 al:1
..............................................UGAAAGUGACUACAUCGu............................................................................................................. len:18 al:1
..............................................UGAAAGaGACUACAUCGGGGU.......................................................................................................... len:21 al:2
..............................................gGAAAGUGACUACAUCGGGGU.......................................................................................................... len:21 al:3
..............................................UGAAAGUGAuUACAUCGGGGU.......................................................................................................... len:21 al:3
..............................................gGAAAGUGACUACAUCGGGGUU......................................................................................................... len:22 al:1
..............................................UGAAAGUGACUACAUCGGGGUUCCGA..................................................................................................... len:26 al:1
..............................................UGAAAGUGACUACAgCGGGGU.......................................................................................................... len:21 al:1
..............................................UGAAAGUGACUACAUCGGGG........................................................................................................... len:20 al:119
..............................................UGAAAGUGACUACAUCGGGGa.......................................................................................................... len:21 al:2
..............................................UGAAAGUGACUACAUgGGGGU.......................................................................................................... len:21 al:1
..............................................UGAAAGUGACUACAUCGGu............................................................................................................ len:19 al:1
..............................................UGAAAGUGACUACAUCGGGGg.......................................................................................................... len:21 al:45
..............................................UGAAAGUGACUACAUCGGGGUc......................................................................................................... len:22 al:6
..............................................UGAAAGUGACUAuAUCGGGGU.......................................................................................................... len:21 al:1
..............................................UGAAAcUGACUACAUCGGGGU.......................................................................................................... len:21 al:1
..............................................UGAAAGUGgCUACAUCGGGG........................................................................................................... len:20 al:1
..............................................UGAAAGUGACUgCAUCGGGGU.......................................................................................................... len:21 al:1
..............................................UGAAAGUGACUACAUCGGc............................................................................................................ len:19 al:1
..............................................UGAAAGUGACUACAUCGGGGUa......................................................................................................... len:22 al:3
..............................................UGAgAGUGACUACAUCGGGGU.......................................................................................................... len:21 al:2
..............................................UGAAAGUGACaACAUCGGGGU.......................................................................................................... len:21 al:3
..............................................UGAAAGUGACUACAUCGGGGUUC........................................................................................................ len:23 al:3
..............................................UGAAAGcGACUACAUCGGGGU.......................................................................................................... len:21 al:3
..............................................UGAAAGUGACgACAUCGGGGU.......................................................................................................... len:21 al:1
..............................................UGAAAGUGACcACAUCGGGGU.......................................................................................................... len:21 al:1
..............................................UGAAAGUGACUACAUuGGGGU.......................................................................................................... len:21 al:2
..............................................UGAAAGUGACUACAUCGGGuUU......................................................................................................... len:22 al:2
..............................................UGAAAGgGACUACAUCGGGGU.......................................................................................................... len:21 al:4
..............................................UGAAAGUGACUACAUCaGGGU.......................................................................................................... len:21 al:1
...............................................GAAAGUGACUACAUCGGGGU.......................................................................................................... len:20 al:1
...............................................GAAAGUGACUACAUC............................................................................................................... len:15 al:1
..................................................AGUGACUACAUCGGGG........................................................................................................... len:16 al:1
...................................................GUGACUACAUCGGGGU.......................................................................................................... len:16 al:1
....................................................UGACUACAUCGGGGUUC........................................................................................................ len:17 al:1
.............................................................................................................AUCAACCCUGGUUUAGUCACU........................................... len:21 al:1
................................................................................................................AACCCUGGUUUAGUCAC............................................ len:17 al:1
................................................................................................................AACCCUGGUUUAGUCACUUUC........................................ len:21 al:1
.................................................................................................................ACCCUGGUUUAGUCACUUUCACUG.................................... len:24 al:6
.................................................................................................................ACCCUGGUUUAGUCACUUUCA....................................... len:21 al:4
.................................................................................................................ACCCUGGUUUAGUCACgUUCACU..................................... len:23 al:1
..................................................................................................................CCCUGGUUUAGUCACUUUC........................................ len:19 al:1
...................................................................................................................CCUGGUUUAGUCACUUUCAC...................................... len:20 al:16
...................................................................................................................CCUGGUUUAGUCACU........................................... len:15 al:3
...................................................................................................................CCUGGUUUAGUCACUUUC........................................ len:18 al:4
...................................................................................................................CCUGGUUUAGaCACUUUCACU..................................... len:21 al:1
...................................................................................................................CCgGGUUUAGUCACUUUCACU..................................... len:21 al:1
...................................................................................................................CCUGGUUcAGUCACUUUCACU..................................... len:21 al:1
...................................................................................................................CCUGGUUUAGUCACaUUCACU..................................... len:21 al:1
...................................................................................................................CCUGGUUUAGUCACcUUCAC...................................... len:20 al:1
...................................................................................................................CCUGGgUUAGUCACUUUCACU..................................... len:21 al:2
...................................................................................................................CCUGGUgUAGUCACUUUCACU..................................... len:21 al:1
...................................................................................................................CCUGGUUUAGUCACUUcCACU..................................... len:21 al:1
...................................................................................................................CCUGGUUUAGUCACUUUCAgU..................................... len:21 al:1
...................................................................................................................CCUGGUUUAGUCACUUUCA....................................... len:19 al:3
...................................................................................................................CCUGGUUUAGUCACUUU......................................... len:17 al:1
...................................................................................................................CCUGGUUaAGUCACUUUCACU..................................... len:21 al:1
...................................................................................................................CCUGGUUUAGUCACUUUCACUu.................................... len:22 al:2
...................................................................................................................CCUGuUUUAGUCACUUUCACU..................................... len:21 al:1
...................................................................................................................aCUGGUUUAGUCACUUUCACU..................................... len:21 al:2
...................................................................................................................CCUGGUUUAGUgACUUUCACU..................................... len:21 al:1
...................................................................................................................CCUGGUUUAGUCACUUUCACU..................................... len:21 al:962
....................................................................................................................CUGGUUUAGUCACUUUCAC...................................... len:19 al:1
....................................................................................................................CUGGUUUAGUCACUUUCACUG.................................... len:21 al:1
....................................................................................................................CUGGUUUAGUCACUUUCACU..................................... len:20 al:72
....................................................................................................................CUGGUUUAGUCACUUUCACUu.................................... len:21 al:1
....................................................................................................................CUGGUUUAGUCACUUUCACg..................................... len:20 al:1
....................................................................................................................CUGGUUUAGgCACUUUCACU..................................... len:20 al:1
.......................................................................................................................GUUUAGUCACUUUCACU..................................... len:17 al:2
........................................................................................................................UUUAGUCACUUUCACUGCgUU................................ len:21 al:1
........................................................................................................................UUUAGUCACUUUCACUGCAU................................. len:20 al:7
........................................................................................................................UUUAGUCACUUUCACUGCAgU................................ len:21 al:1
........................................................................................................................UUUAGUCACcUUCACUGCAUU................................ len:21 al:1
........................................................................................................................UUgAGUCACUUUCACUGCAUU................................ len:21 al:1
........................................................................................................................UUUAGUCACUUUCACUGCA.................................. len:19 al:2
........................................................................................................................UUUAGUCACUUaCACUGCAUU................................ len:21 al:1
........................................................................................................................UUUAGUCACUUUCACUGCAUU................................ len:21 al:806
........................................................................................................................cUUAGUCACUUUCACUGCAUU................................ len:21 al:1
........................................................................................................................UUUAGUCACUUUCACUGCAUUu............................... len:22 al:1
........................................................................................................................UUUAGUCACUUUCAC...................................... len:15 al:1
........................................................................................................................UUUAGgCACUUUCACUGCAUU................................ len:21 al:1
.........................................................................................................................UUAGUCACUUUCACU..................................... len:15 al:1
.........................................................................................................................UUAGUCACUUUCACUGCAUU................................ len:20 al:3
............................................................................................................................GUCACUUUCACUGCAUUAAUC............................ len:21 al:1
.............................................................................................................................UCACUUUCACUGCAUUAAUC............................ len:20 al:1
```



